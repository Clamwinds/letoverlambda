{"version":3,"sources":["base.js"],"names":[],"mappings":"AAAA,IAAI,YAAY,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,YAAY;IAC7C,QAAQ,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,QAAQ;IACnC,KAAK,GAAG,OAAO,CAAC,UAAU,CAAC;IAC3B,uBAAuB,GAAG,OAAO,CAAC,uBAAuB,CAAC,CAAC,YAAY;IACvE,2BAA2B,GAAG,OAAO,CAAC,2BAA2B,CAAC,CAAC,YAAY;IAC/E,yBAAyB,GAAG,OAAO,CAAC,yBAAyB,CAAC,CAAC,YAAY;IAC3E,0BAA0B,GAAG,OAAO,CAAC,0BAA0B,CAAC,CAAC,YAAY;IAC7E,yBAAyB,GAAG,OAAO,CAAC,yBAAyB,CAAC,CAAC,YAAY;IAC3E,0BAA0B,GAAG,OAAO,CAAC,0BAA0B,CAAC,CAAC,YAAY,CAAC;;AAElF,IAAI,EAAE,GAAG,CAAC;;;;;;AAAC,AAMX,IAAI,aAAa,GAAG,YAAW;;AAE7B,cAAY,CAAC,IAAI,CAAC,IAAI,CAAC;;AAAC,AAExB,MAAI,CAAC,WAAW,GAAG,EAAE,CAAC;AACtB,MAAI,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC;CAChB;;;;;AAAA,AAKD,QAAQ,CAAC,aAAa,EAAE,YAAY,CAAC,CAAC;;AAEtC,aAAa,CAAC,SAAS,CAAC,eAAe,GAAG,YAAW;AACnD,SAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;CACtC,CAAA;;AAED,aAAa,CAAC,SAAS,CAAC,YAAY,GAAG,UAAS,EAAE,EAAE;AAClD,SAAO,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;CAC7B;;;;;;AAAA,AAMD,IAAI,yBAAyB,GAAG,UAAS,MAAM,EAAE;AAC/C,MAAI,QAAQ,GAAG;AACX,QAAI,EAAE,EAAE;AACR,eAAW,EAAE,EAAE;AACf,SAAK,EAAE,EAAE;GACZ;;;AAAC,AAGF,MAAI,sBAAsB,GAAG,UAAS,KAAK,EAAE,QAAQ,EAAE;AACrD,WAAM,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;AACzB,UAAI,OAAO,GAAG,QAAQ,CAAC,KAAK,EAAE,CAAC;AAC/B,UAAG,OAAO,OAAO,CAAC,QAAQ,IAAI,UAAU,EAAE;AACxC,eAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;OACzB;KACF;GACF,CAAA;;AAED,MAAI,CAAC,KAAK,GAAG,YAAW;AACtB,WAAO,QAAQ,CAAC,IAAI,CAAC,MAAM,GACvB,QAAQ,CAAC,WAAW,CAAC,MAAM,GAC3B,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC;GAC3B,CAAA;;AAED,MAAI,CAAC,KAAK,GAAG,UAAS,EAAE,EAAE;AACxB,YAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;GACzB,CAAA;;AAED,MAAI,CAAC,gBAAgB,GAAG,UAAS,EAAE,EAAE;AACnC,YAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;GAC/B,CAAA;;AAED,MAAI,CAAC,IAAI,GAAG,UAAS,EAAE,EAAE;AACvB,YAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;GACxB,CAAA;;AAED,MAAI,CAAC,mBAAmB,GAAG,UAAS,cAAc,EAAE;AAClD,QAAG,cAAc,IAAI,CAAC,CAAC,IAAI,cAAc,IAAI,IAAI,EAC/C,OAAO,IAAI,CAAC;;;AAAA,AAGd,QAAI,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,8CAA8C,GAAG,cAAc,GAAG,UAAU,CAAC;;;AAAC,AAGxG,QAAG,cAAc,GAAG,IAAI,CAAC,KAAK,EAAE,EAAE;;AAEhC,4BAAsB,CAAC,KAAK,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC;AAC7C,4BAAsB,CAAC,KAAK,EAAE,QAAQ,CAAC,WAAW,CAAC,CAAC;AACpD,4BAAsB,CAAC,KAAK,EAAE,QAAQ,CAAC,KAAK,CAAC;;;AAAC,AAG9C,aAAO,KAAK,CAAC;KACd;;;AAAA,AAGD,WAAO,IAAI,CAAC;GACb,CAAA;;AAED,MAAI,CAAC,eAAe,GAAG,UAAS,oBAAoB,EAAE;AACpD,QAAI,UAAU,GAAG,MAAM,CAAC,cAAc,EAAE,CAAC;AACzC,QAAG,UAAU,IAAI,IAAI,IAAI,UAAU,YAAY,KAAK,EAAE,OAAO;;;AAAA,AAG7D,WAAM,QAAQ,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;;AAE9B,UAAI,OAAO,GAAG,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;AACpC,aAAO,CAAC,OAAO,CAAC,UAAU,GAAG,UAAU;;AAAC,AAExC,aAAO,CAAC,mBAAmB,CAAC,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,UAAU,EAAE,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;KAChG;GACF,CAAA;;AAED,MAAI,CAAC,cAAc,GAAG,YAAW;AAC/B,QAAI,UAAU,GAAG,MAAM,CAAC,cAAc,EAAE,CAAC;AACzC,QAAG,UAAU,IAAI,IAAI,IAAI,UAAU,YAAY,KAAK,EAAE,OAAO;;;AAAA,AAG7D,WAAM,QAAQ,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;;AAErC,UAAI,OAAO,GAAG,QAAQ,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;AAC3C,aAAO,CAAC,OAAO,CAAC,UAAU,GAAG,UAAU;;AAAC,AAExC,aAAO,CAAC,mBAAmB,CAAC,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,UAAU,EAAE,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;KAChG;;;AAAA,AAGD,WAAM,QAAQ,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;;AAE/B,UAAI,OAAO,GAAG,QAAQ,CAAC,KAAK,CAAC,KAAK,EAAE;;AAAC,AAErC,aAAO,CAAC,OAAO,CAAC,UAAU,GAAG,UAAU;;AAAC,AAExC,aAAO,CAAC,oBAAoB,CAAC,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,UAAU,EAAE,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;KACjG;GACF,CAAA;CACF;;;;;;AAAA,AAMD,IAAI,SAAS,GAAG,YAAW;AACzB,MAAI,MAAM,GAAG,EAAE,CAAC;;AAEhB,MAAI,CAAC,GAAG,GAAG,UAAS,aAAa,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,UAAU,EAAE,iBAAiB,EAAE;;AAE5F,QAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;;AAEzB,UAAI,MAAM,GAAG;AACT,kBAAU,EAAC,QAAQ;AACnB,kBAAU,EAAC,QAAQ;AACnB,YAAI,EAAE,MAAM;AACZ,uBAAe,EAAE,aAAa;AAC9B,2BAAmB,EAAE,iBAAiB;OACzC;;;AAAC,AAGF,UAAG,OAAO,UAAU,IAAI,QAAQ,EAAE;AAChC,cAAM,CAAC,QAAQ,CAAC,GAAG,UAAU,CAAC;OAC/B;;;AAAA,AAGD,YAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;KACrB;GACF,CAAA;;AAED,MAAI,CAAC,QAAQ,GAAG,UAAS,MAAM,EAAE;AAC/B,SAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACrC,UAAG,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,MAAM,EAAE,OAAO,IAAI,CAAC;KACxC;;AAED,WAAO,KAAK,CAAC;GACd,CAAA;;AAED,MAAI,CAAC,MAAM,GAAG,UAAS,MAAM,EAAE;AAC7B,QAAI,QAAQ,GAAG,EAAE;;;AAAC,AAGlB,SAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACrC,UAAG,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,MAAM,EAAE,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;KACrD;;;AAAA,AAGD,UAAM,GAAG,QAAQ,CAAC;GACnB,CAAA;;AAED,MAAI,CAAC,GAAG,GAAG,UAAS,KAAK,EAAE;AACzB,WAAO,MAAM,CAAC,KAAK,CAAC,CAAC;GACtB,CAAA;;AAED,MAAI,CAAC,MAAM,GAAG,YAAW;AACvB,WAAO,MAAM,CAAC,MAAM,CAAC;GACtB,CAAA;;AAED,MAAI,CAAC,OAAO,GAAG,YAAW;AACxB,WAAO,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;GACxB,CAAA;CACF;;;;;;AAAA,AAMD,IAAI,OAAO,GAAG,YAAW;AACvB,MAAI,IAAI,GAAG,EAAE,CAAC;;AAEd,MAAI,CAAC,GAAG,GAAG,UAAS,EAAE,EAAE;AACtB,QAAI,KAAK,GAAG,KAAK;;;AAAC,AAGlB,SAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACnC,UAAG,EAAE,CAAC,YAAY,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,EAAE,KAAK,GAAG,IAAI,CAAC;KAC1D;;;AAAA,AAGD,QAAG,CAAC,KAAK,EAAE;AACT,UAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACf;GACF,CAAA;;AAED,MAAI,CAAC,KAAK,GAAG,YAAW;AACtB,QAAI,GAAG,EAAE,CAAC;GACX,CAAA;;AAED,MAAI,CAAC,EAAE,GAAG,YAAW;AACnB,WAAO,IAAI,CAAC;GACb,CAAA;;AAED,MAAI,CAAC,KAAK,GAAG,UAAS,YAAY,EAAE;;AAElC,SAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACnC,UAAG,YAAY,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,EACrC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;KAClB;;AAED,WAAO,IAAI,CAAC;GACb,CAAA;;AAED,MAAI,CAAC,IAAI,GAAG,UAAS,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,uBAAuB,EAAE;AACrF,QAAI,OAAO,GAAG,KAAK;;;;AAAC,AAIpB,QAAG,CAAC,OAAO,IAAI,uBAAuB,EAAE;AACtC,aAAO,OAAO,CAAC,QAAQ,CAAC,YAAW;AACjC,cAAM,OAAO,CAAC;OACf,CAAC,CAAA;KACH;;;AAAA,AAGD,SAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACnC,UAAG,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;AACtC,YAAG,QAAQ,IAAI,IAAI,IAAI,QAAQ,CAAC,YAAY,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,IAChE,QAAQ,CAAC,GAAG,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;AACjC,cAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,EAAE,MAAM,IAAI,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC;AAChE,iBAAO,GAAG,IAAI,CAAC;SAChB;OACF;KACF;;;AAAA,AAGD,QAAG,OAAO,IACL,KAAK,IAAI,OAAO,IAChB,CAAC,OAAO,IACR,uBAAuB,IACvB,MAAM,IAAI,MAAM,CAAC,EAAE,EAAE;AACtB,aAAO,CAAC,QAAQ,CAAC,YAAW;AAC1B,cAAM,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC;OACtC,CAAC,CAAA;KACL;GACF,CAAA;CACF,CAAA;;AAED,IAAI,IAAI,GAAG,SAAS,IAAI,GAAG;AACzB,cAAY,CAAC,IAAI,CAAC,IAAI,CAAC;;;AAAC,AAGxB,MAAG,IAAI,CAAC,cAAc,IAAI,IAAI,EAAE;AAC9B,QAAI,CAAC,cAAc,GAAG,IAAI,aAAa,EAAE,CAAC;GAC3C;;;AAAA,AAGD,MAAI,IAAI,GAAG,IAAI,SAAS,EAAE,CAAC;;AAE3B,QAAM,CAAC,cAAc,CAAC,IAAI,EAAE,MAAM,EAAE,EAAC,UAAU,EAAE,IAAI;AACjD,OAAG,EAAE,YAAW;AAAE,aAAO,IAAI,CAAC;KAAE;GACnC,CAAC;;;AAAC,AAGH,MAAI,CAAC,cAAc,GAAG,IAAI,aAAa,EAAE;;AAAC,AAE1C,MAAI,CAAC,cAAc,GAAG,IAAI,yBAAyB,CAAC,IAAI,CAAC;;AAAC,AAE1D,MAAI,CAAC,QAAQ,GAAG,IAAI,OAAO,EAAE,CAAC;CAC/B;;;;;AAAA,AAKD,QAAQ,CAAC,IAAI,EAAE,YAAY,CAAC;;;;;AAAC,AAK7B,IAAI,CAAC,SAAS,CAAC,YAAY,GAAG,UAAS,EAAE,EAAE,QAAQ,EAAE;AACnD,uBAAqB,CAAC,IAAI,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,QAAQ,CAAC,CAAC;CAChE,CAAA;;AAED,IAAI,qBAAqB,GAAG,UAAS,IAAI,EAAE,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE;AAC9D,MAAG,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE,OAAO,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;;AAAA,AAElD,MAAI,IAAI,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC;AACzB,MAAI,WAAW,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;AAC3C,MAAI,eAAe,GAAG,WAAW,CAAC,MAAM,CAAC;AACzC,MAAI,OAAO,GAAG,EAAE,CAAC;;AAEjB,MAAG,IAAI,CAAC,aAAa,IAAI,QAAQ,EAAE;;AAEjC,QAAG,OAAO,CAAC,QAAQ,IAAI,OAAO,EAAE;AAC9B,+BAAyB,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;KAC7F,MAAM;AACL,iCAA2B,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;KAC/F;GACF,MAAM,IAAG,IAAI,CAAC,aAAa,IAAI,YAAY,EAAE;AAC5C,2BAAuB,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;GAC3F,MAAM,IAAG,IAAI,CAAC,aAAa,IAAI,aAAa,EAAE;AAC7C,8BAA0B,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;GAC9F,MAAM,IAAG,IAAI,CAAC,aAAa,IAAI,OAAO,EAAE;AACvC,8BAA0B,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;GACjF,MAAM,IAAG,IAAI,CAAC,aAAa,IAAI,cAAc,EAAE;AAC9C,6BAAyB,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;GAChF;CACF;;;;;;AAAA,AAMD,IAAI,CAAC,SAAS,CAAC,8BAA8B,GAAG,UAAS,GAAG,EAAE;;AAE5D,MAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC;;AAAC,AAExD,OAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACnC,QAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;;AAAC,AAEpD,QAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC;;AAAC,AAE7C,WAAO,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;;AAAC,AAEhD,QAAG,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE;AAC9B,aAAO,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;KAC7C;GACF;CACF;;;;;;AAAA,AAMD,IAAI,CAAC,SAAS,CAAC,wCAAwC,GAAG,UAAS,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE;;AAElF,MAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC;;AAAC,AAExD,OAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACnC,QAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;;AAEpD,QAAG,IAAI,IAAI,IAAI,CAAC,UAAU,EAAE;;AAE1B,UAAI,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,IAAI,CAAC;AAC/C,UAAI,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,IAAI;;AAAC,AAE/C,UAAG,KAAK,IAAI,IAAI,IAAI,KAAK,IAAI,IAAI,EAAE;AACjC,YAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC;;AAAC,AAE7C,eAAO,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;;AAAC,AAEhD,YAAG,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE;AAC9B,iBAAO,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;SAC7C;OACF;KACF;GACF;CACF;;;;;;;AAAA,AAOD,IAAI,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAS,UAAU,EAAE,GAAG,EAAE,UAAU,EAAE,OAAO,EAAE,QAAQ,EAAE;;AAEzF,MAAG,OAAO,OAAO,IAAI,UAAU,EAAE;AAC/B,YAAQ,GAAG,OAAO,CAAC;AACnB,WAAO,GAAG,KAAK,CAAC;GACjB;;;AAAA,AAGD,MAAI,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,YAAY,EAAE,EAAE,QAAQ,CAAC;;AAAC,AAE9D,MAAI,CAAC,cAAc,CAAC,WAAW,CAAC,UAAU,CAAC,YAAY,EAAE,CAAC,QAAQ,EAAE,CAAC,GAAG,EAAC,KAAK,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,EAAE,KAAK,EAAE,GAAG,EAAE,UAAU,EAAC,UAAU,EAAE,OAAO,EAAC,OAAO,EAAC,CAAC;CAC3J;;;;;;;AAAA,AAOD,IAAI,CAAC,SAAS,CAAC,kBAAkB,GAAG,UAAS,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE;;AAEpE,MAAI,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,EAAE,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;;AAAC,AAE1D,MAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC;CACtD;;;;;;;AAAA,AAOD,IAAI,CAAC,SAAS,CAAC,qBAAqB,GAAG,UAAS,GAAG,EAAE;AACnD,MAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;;AAExD,OAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACnC,QAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;GACvC;CACF;;;;;;;AAAA,AAOD,IAAI,CAAC,SAAS,CAAC,YAAY,GAAG,UAAS,EAAE,EAAE,QAAQ,EAAE,GAAG,EAAE;AACxD,MAAI,IAAI,GAAG,IAAI;;;AAAC,AAGhB,MAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,MAAM,IAAI,CAAC,EAAE;;AAEhD,QAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE,CAAC;;AAAC,AAE/C,WAAO,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE,CAAC;;AAAC,AAE3C,QAAI,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ;;AAAC,AAE7D,QAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,EAAE,CAAC;;AAAC,AAE3C,QAAG,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE;AAC9B,aAAO,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;KACxC;;AAED,QAAI;;AAEF,UAAG,OAAO,QAAQ,IAAI,UAAU,EAAE,QAAQ,CAAC,GAAG,EAAE,QAAQ,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;KAC5E,CAAC,OAAM,GAAG,EAAE;AACX,UAAI,CAAC,yBAAyB,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;KAC3F;GACF;CACF;;;;;;;AAAA,AAOD,IAAI,CAAC,SAAS,CAAC,WAAW,GAAG,UAAS,EAAE,EAAE;AACxC,SAAO,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC;CACtD;;;;;;;AAAA,AAOD,IAAI,CAAC,SAAS,CAAC,cAAc,GAAG,UAAS,EAAE,EAAE;;AAE3C,MAAG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE,CAAC,IAAI,IAAI,EAAE,OAAO,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;;AAAA,AAE3F,MAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,EAAE,CAAC;;AAAC,AAE3C,MAAG,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE;AAC9B,WAAO,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;GACxC;CACF;;;;;;;AAAA,AAOD,IAAI,CAAC,SAAS,CAAC,YAAY,GAAG,UAAS,EAAE,EAAE;AACzC,MAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE,CAAC;;AAAC,AAE/C,SAAO,EAAC,IAAI,EAAC,IAAI,EAAE,QAAQ,EAAC,AAAC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,MAAM,IAAI,CAAC,GAAI,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,EAAC,CAAA;CAC3H;;;;;;;AAAA,AAOD,IAAI,CAAC,SAAS,CAAC,yBAAyB,GAAG,UAAS,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,eAAe,EAAE,uBAAuB,EAAE;AACtI,MAAG,eAAe,EAAE;AAClB,QAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC;;AAE7B,SAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAClC,UAAG,OAAO,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,IAAI,WAAW,EACxC,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,KAAK,CAAC;KAC7B;GACF;;;AAAA,AAGD,MAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,eAAe,EAAE,QAAQ,EAAE,uBAAuB,CAAC,CAAC;CAChG,CAAA;;AAED,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC","file":"base-compiled.js","sourcesContent":["var EventEmitter = require('events').EventEmitter\n  , inherits = require('util').inherits\n  , utils = require('../utils')\n  , mongodb_cr_authenticate = require('../auth/mongodb_cr.js').authenticate\n  , mongodb_gssapi_authenticate = require('../auth/mongodb_gssapi.js').authenticate\n  , mongodb_sspi_authenticate = require('../auth/mongodb_sspi.js').authenticate\n  , mongodb_plain_authenticate = require('../auth/mongodb_plain.js').authenticate\n  , mongodb_x509_authenticate = require('../auth/mongodb_x509.js').authenticate\n  , mongodb_scram_authenticate = require('../auth/mongodb_scram.js').authenticate;\n\nvar id = 0;\n\n/**\n * Internal class for callback storage\n * @ignore\n */\nvar CallbackStore = function() {\n  // Make class an event emitter\n  EventEmitter.call(this);\n  // Add a info about call variable\n  this._notReplied = {};\n  this.id = id++;\n}\n\n/**\n * @ignore\n */\ninherits(CallbackStore, EventEmitter);\n\nCallbackStore.prototype.notRepliedToIds = function() {\n  return Object.keys(this._notReplied);\n}\n\nCallbackStore.prototype.callbackInfo = function(id) {\n  return this._notReplied[id]; \n}\n\n/**\n * Internal class for holding non-executed commands\n * @ignore\n */\nvar NonExecutedOperationStore = function(config) {  \n  var commands = {\n      read: []\n    , write_reads: []\n    , write: []\n  };\n\n  // Execute all callbacks\n  var fireCallbacksWithError = function(error, commands) {\n    while(commands.length > 0) {\n      var command = commands.shift();\n      if(typeof command.callback == 'function') {\n        command.callback(error);        \n      }\n    }\n  }\n\n  this.count = function() {\n    return commands.read.length\n      + commands.write_reads.length\n      + commands.write.length;\n  }\n\n  this.write = function(op) {\n    commands.write.push(op);\n  }  \n\n  this.read_from_writer = function(op) {  \n    commands.write_reads.push(op);\n  }\n\n  this.read = function(op) {  \n    commands.read.push(op);\n  }  \n\n  this.validateBufferLimit = function(numberToFailOn) {\n    if(numberToFailOn == -1 || numberToFailOn == null) \n      return true;\n\n    // Error passed back\n    var error = utils.toError(\"No connection operations buffering limit of \" + numberToFailOn + \" reached\");\n\n    // If we have passed the number of items to buffer we need to fail\n    if(numberToFailOn < this.count()) {\n      // Fail all of the callbacks\n      fireCallbacksWithError(error, commands.read);\n      fireCallbacksWithError(error, commands.write_reads);\n      fireCallbacksWithError(error, commands.write);\n\n      // Report back that the buffer has been filled\n      return false;\n    }\n\n    // There is still some room to go\n    return true;\n  }\n\n  this.execute_queries = function(executeInsertCommand) {\n    var connection = config.checkoutReader();\n    if(connection == null || connection instanceof Error) return;\n\n    // Write out all the queries\n    while(commands.read.length > 0) {\n      // Get the next command\n      var command = commands.read.shift();\n      command.options.connection = connection;\n      // Execute the next command\n      command.executeQueryCommand(command.db, command.db_command, command.options, command.callback);\n    }\n  }\n\n  this.execute_writes = function() {\n    var connection = config.checkoutWriter();\n    if(connection == null || connection instanceof Error) return;\n\n    // Write out all the queries to the primary\n    while(commands.write_reads.length > 0) {\n      // Get the next command\n      var command = commands.write_reads.shift();\n      command.options.connection = connection;\n      // Execute the next command\n      command.executeQueryCommand(command.db, command.db_command, command.options, command.callback);\n    }\n\n    // Execute all write operations\n    while(commands.write.length > 0) {\n      // Get the next command\n      var command = commands.write.shift();\n      // Set the connection\n      command.options.connection = connection;\n      // Execute the next command\n      command.executeInsertCommand(command.db, command.db_command, command.options, command.callback);\n    }  \n  }\n}\n\n/**\n * Internal class for authentication storage\n * @ignore\n */\nvar AuthStore = function() {\n  var _auths = [];\n\n  this.add = function(authMechanism, dbName, username, password, authdbName, gssapiServiceName) {\n    // Check for duplicates\n    if(!this.contains(dbName)) {\n      // Base config\n      var config = {\n          'username':username\n        , 'password':password\n        , 'db': dbName\n        , 'authMechanism': authMechanism\n        , 'gssapiServiceName': gssapiServiceName\n      };\n\n      // Add auth source if passed in\n      if(typeof authdbName == 'string') {\n        config['authdb'] = authdbName;\n      }\n\n      // Push the config\n      _auths.push(config);\n    }\n  }  \n\n  this.contains = function(dbName) {\n    for(var i = 0; i < _auths.length; i++) {\n      if(_auths[i].db == dbName) return true;\n    }\n\n    return false;\n  }\n\n  this.remove = function(dbName) {\n    var newAuths = [];\n\n    // Filter out all the login details\n    for(var i = 0; i < _auths.length; i++) {\n      if(_auths[i].db != dbName) newAuths.push(_auths[i]);\n    }\n\n    //  Set the filtered list\n    _auths = newAuths;\n  }\n\n  this.get = function(index) {\n    return _auths[index];\n  }\n\n  this.length = function() {\n    return _auths.length;\n  }\n\n  this.toArray = function() {\n    return _auths.slice(0);\n  }\n}\n\n/**\n * Internal class for storing db references\n * @ignore\n */\nvar DbStore = function() {\n  var _dbs = [];\n\n  this.add = function(db) {\n    var found = false;\n    \n    // Only add if it does not exist already\n    for(var i = 0; i < _dbs.length; i++) {\n      if(db.databaseName == _dbs[i].databaseName) found = true;\n    }\n\n    // Only add if it does not already exist\n    if(!found) {\n      _dbs.push(db);    \n    } \n  }\n\n  this.reset = function() {\n    _dbs = [];\n  }\n\n  this.db = function() {\n    return _dbs;\n  }\n\n  this.fetch = function(databaseName) {\n    // Only add if it does not exist already\n    for(var i = 0; i < _dbs.length; i++) {\n      if(databaseName == _dbs[i].databaseName)\n        return _dbs[i];\n    }  \n\n    return null;\n  }\n\n  this.emit = function(event, message, object, reset, filterDb, rethrow_if_no_listeners) {\n    var emitted = false;\n\n    // Not emitted and we have enabled rethrow, let process.uncaughtException\n    // deal with the issue\n    if(!emitted && rethrow_if_no_listeners) {\n      return process.nextTick(function() {\n        throw message;      \n      })\n    }\n\n    // Emit the events\n    for(var i = 0; i < _dbs.length; i++) {    \n      if(_dbs[i].listeners(event).length > 0) {\n        if(filterDb == null || filterDb.databaseName !== _dbs[i].databaseName \n          || filterDb.tag !== _dbs[i].tag) {\n          _dbs[i].emit(event, message, object == null ? _dbs[i] : object);\n          emitted = true;\n        }\n      }\n    }\n\n    // Emit error message\n    if(message \n      && event == 'error' \n      && !emitted\n      && rethrow_if_no_listeners \n      && object && object.db) {\n        process.nextTick(function() {\n          object.db.emit(event, message, null);      \n        })\n    }\n  }\n}\n\nvar Base = function Base() {  \n  EventEmitter.call(this);\n\n  // Callback store is part of connection specification\n  if(Base._callBackStore == null) {\n    Base._callBackStore = new CallbackStore();\n  }\n\n  // Create a new auth store\n  var auth = new AuthStore();\n\n  Object.defineProperty(this, \"auth\", {enumerable: true\n    , get: function() { return auth; }\n  });\n\n  // Create a new callback store  \n  this._callBackStore = new CallbackStore();\n  // All commands not being executed\n  this._commandsStore = new NonExecutedOperationStore(this);\n  // Contains all the dbs attached to this server config\n  this._dbStore = new DbStore();\n}\n\n/**\n * @ignore\n */\ninherits(Base, EventEmitter);\n\n/**\n * @ignore\n */\nBase.prototype._apply_auths = function(db, callback) {\n  _apply_auths_serially(this, db, this.auth.toArray(), callback);\n}\n\nvar _apply_auths_serially = function(self, db, auths, callback) {\n  if(auths.length == 0) return callback(null, null);\n  // Get the first auth\n  var auth = auths.shift();\n  var connections = self.allRawConnections();\n  var connectionsLeft = connections.length;\n  var options = {};\n\n  if(auth.authMechanism == 'GSSAPI') {\n    // We have the kerberos library, execute auth process\n    if(process.platform == 'win32') {\n      mongodb_sspi_authenticate(db, auth.username, auth.password, auth.authdb, options, callback);\n    } else {\n      mongodb_gssapi_authenticate(db, auth.username, auth.password, auth.authdb, options, callback);\n    }\n  } else if(auth.authMechanism == 'MONGODB-CR') {\n    mongodb_cr_authenticate(db, auth.username, auth.password, auth.authdb, options, callback);\n  } else if(auth.authMechanism == 'SCRAM-SHA-1') {\n    mongodb_scram_authenticate(db, auth.username, auth.password, auth.authdb, options, callback);\n  } else if(auth.authMechanism == 'PLAIN') {\n    mongodb_plain_authenticate(db, auth.username, auth.password, options, callback);\n  } else if(auth.authMechanism == 'MONGODB-X509') {\n    mongodb_x509_authenticate(db, auth.username, auth.password, options, callback);\n  }\n}\n\n/**\n * Fire all the errors\n * @ignore\n */\nBase.prototype.__executeAllCallbacksWithError = function(err) {\n  // Check all callbacks\n  var keys = Object.keys(this._callBackStore._notReplied);\n  // For each key check if it's a callback that needs to be returned\n  for(var j = 0; j < keys.length; j++) {\n    var info = this._callBackStore._notReplied[keys[j]];\n    // Execute callback with error\n    this._callBackStore.emit(keys[j], err, null);\n    // Remove the key\n    delete this._callBackStore._notReplied[keys[j]];\n    // Force cleanup _events, node.js seems to set it as a null value\n    if(this._callBackStore._events) {\n      delete this._callBackStore._events[keys[j]];\n    }\n  }\n}\n\n/**\n * Fire all the errors\n * @ignore\n */\nBase.prototype.__executeAllServerSpecificErrorCallbacks = function(host, port, err) {  \n  // Check all callbacks\n  var keys = Object.keys(this._callBackStore._notReplied);\n  // For each key check if it's a callback that needs to be returned\n  for(var j = 0; j < keys.length; j++) {\n    var info = this._callBackStore._notReplied[keys[j]];\n\n    if(info && info.connection) {\n      // Unpack the connection settings\n      var _host = info.connection.socketOptions.host;\n      var _port = info.connection.socketOptions.port;\n      // If the server matches execute the callback with the error\n      if(_port == port && _host == host) {\n        this._callBackStore.emit(keys[j], err, null);\n        // Remove the key\n        delete this._callBackStore._notReplied[keys[j]];\n        // Force cleanup _events, node.js seems to set it as a null value\n        if(this._callBackStore._events) {\n          delete this._callBackStore._events[keys[j]];\n        } \n      }      \n    }\n  }\n}\n\n/**\n * Register a handler\n * @ignore\n * @api private\n */\nBase.prototype._registerHandler = function(db_command, raw, connection, exhaust, callback) {\n  // Check if we have exhausted\n  if(typeof exhaust == 'function') {\n    callback = exhaust;\n    exhaust = false;\n  }\n\n  // Add the callback to the list of handlers\n  this._callBackStore.once(db_command.getRequestId(), callback);\n  // Add the information about the reply\n  this._callBackStore._notReplied[db_command.getRequestId().toString()] = {start: new Date().getTime(), 'raw': raw, connection:connection, exhaust:exhaust};\n}\n\n/**\n * Re-Register a handler, on the cursor id f.ex\n * @ignore\n * @api private\n */\nBase.prototype._reRegisterHandler = function(newId, object, callback) {\n  // Add the callback to the list of handlers\n  this._callBackStore.once(newId, object.callback.listener);\n  // Add the information about the reply\n  this._callBackStore._notReplied[newId] = object.info;\n}\n\n/**\n *\n * @ignore\n * @api private\n */\nBase.prototype._flushAllCallHandlers = function(err) {\n  var keys = Object.keys(this._callBackStore._notReplied);\n\n  for(var i = 0; i < keys.length; i++) {\n    this._callHandler(keys[i], null, err);\n  }\n}\n\n/**\n *\n * @ignore\n * @api private\n */\nBase.prototype._callHandler = function(id, document, err) {\n  var self = this;\n\n  // If there is a callback peform it\n  if(this._callBackStore.listeners(id).length >= 1) {\n    // Get info object\n    var info = this._callBackStore._notReplied[id];\n    // Delete the current object\n    delete this._callBackStore._notReplied[id]; \n    // Call the handle directly don't emit\n    var callback = this._callBackStore.listeners(id)[0].listener;\n    // Remove the listeners\n    this._callBackStore.removeAllListeners(id);\n    // Force key deletion because it nulling it not deleting in 0.10.X\n    if(this._callBackStore._events) {\n      delete this._callBackStore._events[id];\n    }\n\n    try {\n      // Execute the callback if one was provided\n      if(typeof callback == 'function') callback(err, document, info.connection);\n    } catch(err) {\n      self._emitAcrossAllDbInstances(self, null, \"error\", utils.toError(err), self, true, true);\n    }\n  }\n}\n\n/**\n *\n * @ignore\n * @api private\n */\nBase.prototype._hasHandler = function(id) {\n  return this._callBackStore.listeners(id).length >= 1;\n}\n\n/**\n *\n * @ignore\n * @api private\n */\nBase.prototype._removeHandler = function(id) {\n  // Remove the information\n  if(this._callBackStore._notReplied[id] != null) delete this._callBackStore._notReplied[id];\n  // Remove the callback if it's registered\n  this._callBackStore.removeAllListeners(id);\n  // Force cleanup _events, node.js seems to set it as a null value\n  if(this._callBackStore._events) {\n    delete this._callBackStore._events[id];\n  }\n}\n\n/**\n *\n * @ignore\n * @api private\n */\nBase.prototype._findHandler = function(id) {\n  var info = this._callBackStore._notReplied[id];\n  // Return the callback\n  return {info:info, callback:(this._callBackStore.listeners(id).length >= 1) ? this._callBackStore.listeners(id)[0] : null}\n}\n\n/**\n *\n * @ignore\n * @api private\n */\nBase.prototype._emitAcrossAllDbInstances = function(server, filterDb, event, message, object, resetConnection, rethrow_if_no_listeners) {\n  if(resetConnection) {\n    var dbs = this._dbStore.db();\n\n    for(var i = 0; i < dbs.length; i++) {\n      if(typeof dbs[i].openCalled != 'undefined')\n        dbs[i].openCalled = false;\n    }\n  }\n  \n  // Fire event\n  this._dbStore.emit(event, message, object, resetConnection, filterDb, rethrow_if_no_listeners);\n}\n\nexports.Base = Base;"]}