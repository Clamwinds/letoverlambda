{"version":3,"sources":["shared.js"],"names":[],"mappings":"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","file":"shared-compiled.js","sourcesContent":["// ***************************************************\n// Write concerns\n// ***************************************************\nvar _hasWriteConcern = function(errorOptions) {\n  return errorOptions == true\n    || errorOptions.w > 0\n    || errorOptions.w == 'majority'\n    || errorOptions.j == true\n    || errorOptions.journal == true\n    || errorOptions.fsync == true\n}\n\nvar _setWriteConcernHash = function(options) {\n  var finalOptions = {};\n  if(options.w != null) finalOptions.w = options.w;  \n  if(options.journal == true) finalOptions.j = options.journal;\n  if(options.j == true) finalOptions.j = options.j;\n  if(options.fsync == true) finalOptions.fsync = options.fsync;\n  if(options.wtimeout != null) finalOptions.wtimeout = options.wtimeout;  \n  return finalOptions;\n}\n\nvar _getWriteConcern = function(self, options) {\n  // Final options\n  var finalOptions = {w:1};\n  // Local options verification\n  if(options.w != null || typeof options.j == 'boolean' || typeof options.journal == 'boolean' || typeof options.fsync == 'boolean') {\n    finalOptions = _setWriteConcernHash(options);\n  } else if(typeof options.safe == \"boolean\") {\n    finalOptions = {w: (options.safe ? 1 : 0)};\n  } else if(options.safe != null && typeof options.safe == 'object') {\n    finalOptions = _setWriteConcernHash(options.safe);\n  } else if(self.opts.w != null || typeof self.opts.j == 'boolean' || typeof self.opts.journal == 'boolean' || typeof self.opts.fsync == 'boolean') {\n    finalOptions = _setWriteConcernHash(self.opts);\n  } else if(typeof self.opts.safe == \"boolean\") {\n    finalOptions = {w: (self.opts.safe ? 1 : 0)};\n  } else if(self.db.safe.w != null || typeof self.db.safe.j == 'boolean' || typeof self.db.safe.journal == 'boolean' || typeof self.db.safe.fsync == 'boolean') {\n    finalOptions = _setWriteConcernHash(self.db.safe);\n  } else if(self.db.options.w != null || typeof self.db.options.j == 'boolean' || typeof self.db.options.journal == 'boolean' || typeof self.db.options.fsync == 'boolean') {\n    finalOptions = _setWriteConcernHash(self.db.options);\n  } else if(typeof self.db.safe == \"boolean\") {\n    finalOptions = {w: (self.db.safe ? 1 : 0)};\n  }\n\n  // Ensure we don't have an invalid combination of write concerns\n  if(finalOptions.w < 1 \n    && (finalOptions.journal == true || finalOptions.j == true || finalOptions.fsync == true)) throw new Error(\"No acknowlegement using w < 1 cannot be combined with journal:true or fsync:true\");\n\n  // Return the options\n  return finalOptions;\n}\n\nvar _getReadConcern = function(self, options) {\n  if(options.readPreference) return options.readPreference;\n  if(self.readPreference) return self.readPreference;\n  if(self.db.readPreference) return self.readPreference;\n  return 'primary';\n}\n\n/**\n * @ignore\n */\nvar checkCollectionName = function checkCollectionName (collectionName) {\n  if('string' !== typeof collectionName) {\n    throw Error(\"collection name must be a String\");\n  }\n\n  if(!collectionName || collectionName.indexOf('..') != -1) {\n    throw Error(\"collection names cannot be empty\");\n  }\n\n  if(collectionName.indexOf('$') != -1 &&\n      collectionName.match(/((^\\$cmd)|(oplog\\.\\$main))/) == null) {\n    throw Error(\"collection names must not contain '$'\");\n  }\n\n  if(collectionName.match(/^\\.|\\.$/) != null) {\n    throw Error(\"collection names must not start or end with '.'\");\n  }\n\n  // Validate that we are not passing 0x00 in the colletion name\n  if(!!~collectionName.indexOf(\"\\x00\")) {\n    throw new Error(\"collection names cannot contain a null character\");\n  }\n};\n\n\n/**\n * Normalizes a `hint` argument.\n *\n * @param {String|Object|Array} hint\n * @return {Object}\n * @api private\n */\nvar normalizeHintField = function normalizeHintField(hint) {\n  var finalHint = null;\n\n  if(typeof hint == 'string') {\n    finalHint = hint;\n  } else if(Array.isArray(hint)) {\n    finalHint = {};\n\n    hint.forEach(function(param) {\n      finalHint[param] = 1;\n    });  \n  } else if(hint != null && typeof hint == 'object') {\n    finalHint = {};\n    for (var name in hint) {\n      finalHint[name] = hint[name];\n    }    \n  }\n\n  return finalHint;\n};\n\nexports._getWriteConcern = _getWriteConcern;\nexports._hasWriteConcern = _hasWriteConcern;\nexports._getReadConcern = _getReadConcern;\nexports.checkCollectionName = checkCollectionName;\nexports.normalizeHintField = normalizeHintField;"]}