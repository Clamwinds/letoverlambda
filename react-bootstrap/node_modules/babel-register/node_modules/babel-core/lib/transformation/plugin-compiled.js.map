{"version":3,"sources":["plugin.js"],"names":[],"mappings":"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","file":"plugin-compiled.js","sourcesContent":["/* @noflow */\n\n\"use strict\";\n\nvar _inherits = require(\"babel-runtime/helpers/inherits\")[\"default\"];\n\nvar _classCallCheck = require(\"babel-runtime/helpers/class-call-check\")[\"default\"];\n\nvar _getIterator = require(\"babel-runtime/core-js/get-iterator\")[\"default\"];\n\nvar _interopRequireDefault = require(\"babel-runtime/helpers/interop-require-default\")[\"default\"];\n\nvar _interopRequireWildcard = require(\"babel-runtime/helpers/interop-require-wildcard\")[\"default\"];\n\nexports.__esModule = true;\n\nvar _fileOptionsOptionManager = require(\"./file/options/option-manager\");\n\nvar _fileOptionsOptionManager2 = _interopRequireDefault(_fileOptionsOptionManager);\n\nvar _babelMessages = require(\"babel-messages\");\n\nvar messages = _interopRequireWildcard(_babelMessages);\n\nvar _store = require(\"../store\");\n\nvar _store2 = _interopRequireDefault(_store);\n\nvar _babelTraverse = require(\"babel-traverse\");\n\nvar _babelTraverse2 = _interopRequireDefault(_babelTraverse);\n\nvar _lodashObjectAssign = require(\"lodash/object/assign\");\n\nvar _lodashObjectAssign2 = _interopRequireDefault(_lodashObjectAssign);\n\nvar _lodashLangClone = require(\"lodash/lang/clone\");\n\nvar _lodashLangClone2 = _interopRequireDefault(_lodashLangClone);\n\nvar GLOBAL_VISITOR_PROPS = [\"enter\", \"exit\"];\n\nvar Plugin = (function (_Store) {\n  _inherits(Plugin, _Store);\n\n  function Plugin(plugin /*: Object*/, key /*:: ?: string*/) {\n    _classCallCheck(this, Plugin);\n\n    _Store.call(this);\n\n    this.initialized = false;\n    this.raw = _lodashObjectAssign2[\"default\"]({}, plugin);\n    this.key = key;\n\n    this.manipulateOptions = this.take(\"manipulateOptions\");\n    this.post = this.take(\"post\");\n    this.pre = this.take(\"pre\");\n    this.visitor = this.normaliseVisitor(_lodashLangClone2[\"default\"](this.take(\"visitor\")) || {});\n  }\n\n  Plugin.prototype.take = function take(key) {\n    var val = this.raw[key];\n    delete this.raw[key];\n    return val;\n  };\n\n  Plugin.prototype.chain = function chain(target, key) {\n    if (!target[key]) return this[key];\n    if (!this[key]) return target[key];\n\n    var fns /*: Array<?Function>*/ = [target[key], this[key]];\n\n    return function () {\n      var val = undefined;\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      for (var _iterator = fns, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _getIterator(_iterator);;) {\n        var _ref;\n\n        if (_isArray) {\n          if (_i >= _iterator.length) break;\n          _ref = _iterator[_i++];\n        } else {\n          _i = _iterator.next();\n          if (_i.done) break;\n          _ref = _i.value;\n        }\n\n        var fn = _ref;\n\n        if (fn) {\n          var ret = fn.apply(this, args);\n          if (ret != null) val = ret;\n        }\n      }\n      return val;\n    };\n  };\n\n  Plugin.prototype.maybeInherit = function maybeInherit(loc /*: string*/) {\n    var inherits = this.take(\"inherits\");\n    if (!inherits) return;\n\n    inherits = _fileOptionsOptionManager2[\"default\"].normalisePlugin(inherits, loc, \"inherits\");\n\n    this.manipulateOptions = this.chain(inherits, \"manipulateOptions\");\n    this.post = this.chain(inherits, \"post\");\n    this.pre = this.chain(inherits, \"pre\");\n    this.visitor = _babelTraverse2[\"default\"].visitors.merge([inherits.visitor, this.visitor]);\n  };\n\n  /**\n   * We lazy initialise parts of a plugin that rely on contextual information such as\n   * position on disk and how it was specified.\n   */\n\n  Plugin.prototype.init = function init(loc /*: string*/, i /*: number*/) {\n    if (this.initialized) return;\n    this.initialized = true;\n\n    this.maybeInherit(loc);\n\n    for (var key in this.raw) {\n      throw new Error(messages.get(\"pluginInvalidProperty\", loc, i, key));\n    }\n  };\n\n  Plugin.prototype.normaliseVisitor = function normaliseVisitor(visitor /*: Object*/) /*: Object*/ {\n    for (var _iterator2 = GLOBAL_VISITOR_PROPS, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _getIterator(_iterator2);;) {\n      var _ref2;\n\n      if (_isArray2) {\n        if (_i2 >= _iterator2.length) break;\n        _ref2 = _iterator2[_i2++];\n      } else {\n        _i2 = _iterator2.next();\n        if (_i2.done) break;\n        _ref2 = _i2.value;\n      }\n\n      var key = _ref2;\n\n      if (visitor[key]) {\n        throw new Error(\"Plugins aren't allowed to specify catch-all enter/exit handlers. Please target individual nodes.\");\n      }\n    }\n\n    _babelTraverse2[\"default\"].explode(visitor);\n    return visitor;\n  };\n\n  return Plugin;\n})(_store2[\"default\"]);\n\nexports[\"default\"] = Plugin;\nmodule.exports = exports[\"default\"];"]}